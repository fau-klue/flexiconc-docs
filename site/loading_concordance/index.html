
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../adding_nodes/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Loading Concordance - FlexiConc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#loading-concordances" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FlexiConc" class="md-header__button md-logo" aria-label="FlexiConc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FlexiConc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Loading Concordance
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FlexiConc" class="md-nav__button md-logo" aria-label="FlexiConc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FlexiConc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Loading Concordance
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Loading Concordance
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-internal-structure-of-the-concordance-object" class="md-nav__link">
    <span class="md-ellipsis">
      1. Internal Structure of the Concordance Object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Internal Structure of the Concordance Object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-metadata-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      A. Metadata DataFrame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tokens-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      B. Tokens DataFrame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-matches-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      C. Matches DataFrame
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-how-to-load-data" class="md-nav__link">
    <span class="md-ellipsis">
      2. How to Load Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. How to Load Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concordanceload-method" class="md-nav__link">
    <span class="md-ellipsis">
      Concordance.load() Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-details-and-options" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Details and Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-utility-functions-for-external-systems" class="md-nav__link">
    <span class="md-ellipsis">
      3. Utility Functions for External Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Utility Functions for External Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-retrieving-from-cwb" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Retrieving from CWB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-retrieving-from-clic" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Retrieving from CLiC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-retrieving-from-sketchengine" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Retrieving from SketchEngine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding Nodes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concordance_views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concordance Views
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/selecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selecting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/ranking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/partitioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-internal-structure-of-the-concordance-object" class="md-nav__link">
    <span class="md-ellipsis">
      1. Internal Structure of the Concordance Object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Internal Structure of the Concordance Object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-metadata-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      A. Metadata DataFrame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tokens-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      B. Tokens DataFrame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-matches-dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      C. Matches DataFrame
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-how-to-load-data" class="md-nav__link">
    <span class="md-ellipsis">
      2. How to Load Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. How to Load Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concordanceload-method" class="md-nav__link">
    <span class="md-ellipsis">
      Concordance.load() Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-details-and-options" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Details and Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-utility-functions-for-external-systems" class="md-nav__link">
    <span class="md-ellipsis">
      3. Utility Functions for External Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Utility Functions for External Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-retrieving-from-cwb" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Retrieving from CWB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-retrieving-from-clic" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Retrieving from CLiC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-retrieving-from-sketchengine" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Retrieving from SketchEngine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="loading-concordances">Loading Concordances<a class="headerlink" href="#loading-concordances" title="Permanent link">&para;</a></h1>
<p>FlexiConc is designed to handle large corpora by standardizing the way concordance data is stored and processed. Internally, a <strong>Concordance</strong> object always contains three Pandas DataFrames—<strong>metadata</strong>, <strong>tokens</strong>, and <strong>matches</strong>—which together form its internal structure. The key decision is not whether these tables exist (they always do) but rather how you choose to populate them.</p>
<hr />
<h2 id="1-internal-structure-of-the-concordance-object">1. Internal Structure of the Concordance Object<a class="headerlink" href="#1-internal-structure-of-the-concordance-object" title="Permanent link">&para;</a></h2>
<p>The Concordance object maintains three DataFrames that hold different aspects of the concordance data:</p>
<h3 id="a-metadata-dataframe">A. Metadata DataFrame<a class="headerlink" href="#a-metadata-dataframe" title="Permanent link">&para;</a></h3>
<p>This table stores structural information about each concordance line. It must include a unique identifier, <strong>line_id</strong>, for each row. Additional columns may include details such as the source text identifier, chapter, paragraph, and sentence.</p>
<p>For example, the metadata table might be structured as follows:</p>
<table>
<thead>
<tr>
<th>line_id</th>
<th>text_id</th>
<th>chapter</th>
<th>paragraph</th>
<th>sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>ED</td>
<td>10</td>
<td>35</td>
<td>63</td>
</tr>
<tr>
<td>1</td>
<td>ED</td>
<td>10</td>
<td>36</td>
<td>71</td>
</tr>
<tr>
<td>2</td>
<td>ED</td>
<td>14</td>
<td>115</td>
<td>262</td>
</tr>
<tr>
<td>3</td>
<td>ED</td>
<td>23</td>
<td>7</td>
<td>78</td>
</tr>
<tr>
<td>4</td>
<td>LD</td>
<td>45</td>
<td>85</td>
<td>192</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="b-tokens-dataframe">B. Tokens DataFrame<a class="headerlink" href="#b-tokens-dataframe" title="Permanent link">&para;</a></h3>
<p>The tokens DataFrame holds token-level details for each concordance line. It must include <strong>line_id</strong> to link tokens to their corresponding metadata entry. In addition, the tokens DataFrame typically contains:</p>
<ul>
<li>
<p><strong>offset:</strong> Indicates the token’s relative position to the matched (node) token:</p>
<ul>
<li>Negative values represent tokens in the left context.</li>
<li>Zero marks the matched (node) token(s).</li>
<li>Positive values represent tokens in the right context.</li>
</ul>
</li>
<li>
<p><strong>id_in_line:</strong> (Optional) The token’s sequential index within the line. If omitted, FlexiConc will reconstruct it.</p>
</li>
<li><strong>word:</strong> The token text.</li>
<li>Other attributes such as part-of-speech, lemma, etc., may also be provided.</li>
</ul>
<p>A tokens table might look like this:</p>
<table>
<thead>
<tr>
<th>cpos</th>
<th>offset</th>
<th>word</th>
<th>pos</th>
<th>lemma</th>
<th>line_id</th>
<th>id_in_line</th>
</tr>
</thead>
<tbody>
<tr>
<td>445643</td>
<td>-20</td>
<td>to</td>
<td>IN</td>
<td>to</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>445644</td>
<td>-19</td>
<td>the</td>
<td>DT</td>
<td>the</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>445645</td>
<td>-18</td>
<td>toll-keeper</td>
<td>JJ</td>
<td>toll-keeper</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>445646</td>
<td>-17</td>
<td>keeper</td>
<td>NN</td>
<td>keeper</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>445647</td>
<td>-16</td>
<td>.</td>
<td>.</td>
<td>.</td>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>445648</td>
<td>-15</td>
<td>then</td>
<td>RB</td>
<td>then</td>
<td>0</td>
<td>5</td>
</tr>
<tr>
<td>445649</td>
<td>-14</td>
<td>he</td>
<td>PRP</td>
<td>he</td>
<td>0</td>
<td>6</td>
</tr>
</tbody>
</table>
<p><em>Notes:</em>
- The <strong>cpos</strong> column (optional) represents the corpus position index when available.
- The <strong>offset</strong> column is critical if you choose not to provide a separate matches table.</p>
<hr />
<h3 id="c-matches-dataframe">C. Matches DataFrame<a class="headerlink" href="#c-matches-dataframe" title="Permanent link">&para;</a></h3>
<p>The matches DataFrame specifies the match location when the tokens file does not include an <strong>offset</strong> column. It must include:</p>
<ul>
<li><strong>line_id:</strong> To associate the match with its corresponding metadata row.</li>
<li><strong>match_start</strong> and <strong>match_end:</strong> Indicate the token indices that mark the beginning and end of the match.</li>
<li><strong>slot:</strong> An integer that allows for multiple matches per line.</li>
</ul>
<p>An example matches table might look like this:</p>
<table>
<thead>
<tr>
<th>line_id</th>
<th>match_start</th>
<th>match_end</th>
<th>slot</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>20</td>
<td>20</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>61</td>
<td>61</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>102</td>
<td>102</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>143</td>
<td>143</td>
<td>0</td>
</tr>
</tbody>
</table>
<h2 id="2-how-to-load-data">2. How to Load Data<a class="headerlink" href="#2-how-to-load-data" title="Permanent link">&para;</a></h2>
<p>FlexiConc’s <code>Concordance.load()</code> method is used to populate the three internal DataFrames—<strong>metadata</strong>, <strong>tokens</strong>, and <strong>matches</strong>—from external data files. The method is designed to accept TSV (Tab-Separated Values) files based on the MTSV format proposed by Anthony &amp; Evert (2019).</p>
<h3 id="concordanceload-method">Concordance.load() Method<a class="headerlink" href="#concordanceload-method" title="Permanent link">&para;</a></h3>
<p>The <code>load()</code> method accepts file paths for:
- <strong>metadata</strong>: A TSV file containing structural information about each line.
- <strong>tokens</strong>: A TSV file containing token-level data.
- <strong>matches</strong> (optional): A TSV file containing match location details if your tokens file does not provide an <code>offset</code> column.
- <strong>info</strong> (optional): A JSON file or dictionary with additional information.</p>
<p>The method reads these files using Pandas and assigns the resulting DataFrames to the Concordance object’s attributes. It automatically checks for the presence of required columns such as <code>line_id</code> in the metadata file. In the tokens file, if the <code>id_in_line</code> column is missing, the method reconstructs it based on the token order. Similarly, if the tokens file includes an <code>offset</code> column, the matches table is optional; otherwise, you must provide a matches table to specify the match location.</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>Assuming you have TSV files with headers, you can load them as follows:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flexiconc.concordance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Concordance</span>

<span class="c1"># Create the Concordance object</span>
<span class="n">concordance</span> <span class="o">=</span> <span class="n">Concordance</span><span class="p">()</span>

<span class="c1"># Option A: Tokens file includes &#39;offset&#39;</span>
<span class="n">concordance</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">metadata</span><span class="o">=</span><span class="s2">&quot;path/to/metadata.tsv&quot;</span><span class="p">,</span>  <span class="c1"># must contain &#39;line_id&#39; and other structural columns</span>
    <span class="n">tokens</span><span class="o">=</span><span class="s2">&quot;path/to/tokens.tsv&quot;</span><span class="p">,</span>      <span class="c1"># must contain &#39;line_id&#39; and &#39;offset&#39; (id_in_line is optional)</span>
    <span class="n">info</span><span class="o">=</span><span class="s2">&quot;path/to/info.json&quot;</span>          <span class="c1"># optional additional information</span>
<span class="p">)</span>

<span class="c1"># Option B: Tokens file does NOT include &#39;offset&#39;; matches provided separately</span>
<span class="n">concordance</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">metadata</span><span class="o">=</span><span class="s2">&quot;path/to/metadata.tsv&quot;</span><span class="p">,</span>   <span class="c1"># must contain &#39;line_id&#39;</span>
    <span class="n">tokens</span><span class="o">=</span><span class="s2">&quot;path/to/tokens.tsv&quot;</span><span class="p">,</span>       <span class="c1"># must contain &#39;line_id&#39; (other token attributes as needed)</span>
    <span class="n">matches</span><span class="o">=</span><span class="s2">&quot;path/to/matches.tsv&quot;</span><span class="p">,</span>     <span class="c1"># must contain &#39;line_id&#39;, &#39;match_start&#39;, &#39;match_end&#39;, and &#39;slot&#39;</span>
    <span class="n">info</span><span class="o">=</span><span class="s2">&quot;path/to/info.json&quot;</span>           <span class="c1"># optional additional information</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="technical-details-and-options">Technical Details and Options<a class="headerlink" href="#technical-details-and-options" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>TSV Files with Headers:</strong><br />
  The load method assumes that each TSV file has a header row. This header is used to name the columns of the DataFrame. For example, the metadata TSV should include a header line like:</li>
</ul>
<div class="highlight"><pre><span></span><code>line_id   text_id   chapter   paragraph   sentence
</code></pre></div>
<p>Similarly, the tokens TSV must have headers for columns such as <code>line_id</code>, <code>offset</code>, and optionally <code>id_in_line</code>, along with token attributes like <code>word</code>, <code>pos</code>, etc.</p>
<ul>
<li>
<p><strong>Providing Offsets vs. Matches Table:</strong></p>
<ul>
<li><strong>With Offsets:</strong><br />
  If your tokens file includes an <code>offset</code> column, the load method uses it to determine the token’s relative position (negative for left context, zero for the matched token, positive for right context). In this configuration, you do not need to supply a matches table.  </li>
<li>
<p><strong>Without Offsets:</strong><br />
  If the tokens file lacks an <code>offset</code> column, you must provide a matches table. The matches file should include:</p>
<ul>
<li><code>line_id</code>: To link the match to the correct metadata entry.</li>
<li><code>match_start</code> and <code>match_end</code>: Token indices that mark the beginning and end of the match.</li>
</ul>
<p>It can also include:</p>
<ul>
<li><code>slot</code>: An integer value that is used to determine the focus of concordance operations if a line contains multiple matches.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Omission of <code>id_in_line</code>:</strong><br />
  The tokens file may or may not include an <code>id_in_line</code> column. If it is omitted, FlexiConc will reconstruct it by ordering the tokens within each line based on their original position.</p>
</li>
<li>
<p><strong>Internal Consistency:</strong><br />
  Regardless of which option you choose, the <code>load()</code> method guarantees that the Concordance object will have all three internal DataFrames:</p>
<ul>
<li><strong>metadata</strong>: Contains structural data.</li>
<li><strong>tokens</strong>: Contains token-level data.</li>
<li><strong>matches</strong>: Contains match location data (either directly provided or inferred from the tokens).</li>
</ul>
</li>
</ul>
<p>By providing the data in these formats, FlexiConc ensures that all subsequent analyses—such as building an analysis tree or applying algorithms—work on a consistent and standardized dataset.</p>
<hr />
<h2 id="3-utility-functions-for-external-systems">3. Utility Functions for External Systems<a class="headerlink" href="#3-utility-functions-for-external-systems" title="Permanent link">&para;</a></h2>
<p>FlexiConc provides a set of utility functions to retrieve concordance data from external corpus systems. These functions automatically build and populate the internal DataFrames (<strong>metadata</strong>, <strong>tokens</strong>, and <strong>matches</strong>) by processing raw query results. The following sections describe each retrieval function in detail, including the required arguments and example calls.</p>
<hr />
<h3 id="31-retrieving-from-cwb">3.1 Retrieving from CWB<a class="headerlink" href="#31-retrieving-from-cwb" title="Permanent link">&para;</a></h3>
<p>The function to retrieve data from the Corpus Workbench (CWB) requires the following arguments:</p>
<ul>
<li><strong>registry_dir</strong> (str):<br />
  The path to the CWB registry directory.</li>
<li><strong>corpus_name</strong> (str):<br />
  The name of the corpus to be queried.</li>
<li><strong>query</strong> (str):<br />
  The search query string.</li>
<li><strong>tokens_attrs</strong> (list of str):<br />
  A list of token-level attribute names to retrieve (e.g., <code>["word", "lemma", "pos"]</code>).</li>
<li><strong>metadata_attrs</strong> (list of str):<br />
  A list of metadata attribute names to retrieve (e.g., <code>["speaker", "chapter", "paragraph"]</code>).</li>
<li><strong>context</strong> (int):<br />
  The number of tokens to include as context on each side of the matched token.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">concordance</span><span class="o">.</span><span class="n">retrieve_from_cwb</span><span class="p">(</span>
    <span class="n">registry_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/cwb/registry&quot;</span><span class="p">,</span>
    <span class="n">corpus_name</span><span class="o">=</span><span class="s2">&quot;my_corpus&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;search_term&quot;</span><span class="p">,</span>
    <span class="n">tokens_attrs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="s2">&quot;lemma&quot;</span><span class="p">,</span> <span class="s2">&quot;pos&quot;</span><span class="p">],</span>
    <span class="n">metadata_attrs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;speaker&quot;</span><span class="p">,</span> <span class="s2">&quot;chapter&quot;</span><span class="p">,</span> <span class="s2">&quot;paragraph&quot;</span><span class="p">],</span>
    <span class="n">context</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>
</code></pre></div>
<p>Internally, this function performs the following steps:
1. Instantiates a CWB Corpus object using the specified registry directory and corpus name.
2. Executes the query with the provided context.
3. Converts the raw output into DataFrames for metadata, tokens, and, if necessary, matches by unnesting token-level data and computing token positions.
4. Populates the Concordance object with these DataFrames.</p>
<hr />
<h3 id="32-retrieving-from-clic">3.2 Retrieving from CLiC<a class="headerlink" href="#32-retrieving-from-clic" title="Permanent link">&para;</a></h3>
<p>The retrieval function for CLiC is designed for corpora accessible via the CLiC API. It accepts the following arguments:</p>
<ul>
<li><strong>query</strong> (list of str):<br />
  A list containing one or more query strings.</li>
<li><strong>corpora</strong> (str):<br />
  The identifier(s) for the corpus or corpora to search.</li>
<li><strong>subset</strong> (str):<br />
  A string specifying which subset of the corpus to search (e.g., <code>"all"</code>, <code>"quote"</code>, or <code>"nonquote"</code>).</li>
<li><strong>contextsize</strong> (int):<br />
  The number of tokens of context to include on each side of the match.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">concordance</span><span class="o">.</span><span class="n">retrieve_from_clic</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;search term&quot;</span><span class="p">],</span>
    <span class="n">corpora</span><span class="o">=</span><span class="s2">&quot;my_corpora&quot;</span><span class="p">,</span>
    <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">contextsize</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>
</code></pre></div>
<p>This function works as follows:
1. Sends HTTP GET requests to the CLiC API with the specified parameters.
2. Parses the JSON response to extract both metadata and token-level details.
3. Aggregates tokens from nested JSON structures and assigns proper <code>line_id</code> values.
4. Constructs the internal DataFrames and assigns them to the Concordance object.</p>
<hr />
<h3 id="33-retrieving-from-sketchengine">3.3 Retrieving from SketchEngine<a class="headerlink" href="#33-retrieving-from-sketchengine" title="Permanent link">&para;</a></h3>
<p>The SketchEngine retrieval function is used to retrieve concordance data via the SketchEngine API. It requires these arguments:</p>
<ul>
<li><strong>query</strong> (str):<br />
  The search query string.</li>
<li><strong>corpus</strong> (str):<br />
  The identifier for the target corpus (e.g., <code>"bnc2"</code>).</li>
<li><strong>api_username</strong> (str):<br />
  Your SketchEngine username.</li>
<li><strong>api_key</strong> (str):<br />
  Your SketchEngine API key.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">concordance</span><span class="o">.</span><span class="n">retrieve_from_sketchengine</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;search_term&quot;</span><span class="p">,</span>
    <span class="n">corpus</span><span class="o">=</span><span class="s2">&quot;bnc2&quot;</span><span class="p">,</span>
    <span class="n">api_username</span><span class="o">=</span><span class="s2">&quot;your_username&quot;</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your_api_key&quot;</span>
<span class="p">)</span>
</code></pre></div>
<p>This function operates as follows:
1. Constructs an authenticated HTTP request using your API credentials.
2. Retrieves the JSON response containing both token-level and structural data.
3. Unnests the token data and maps structural details to create the <strong>metadata</strong>, <strong>tokens</strong>, and <strong>matches</strong> DataFrames.
4. Computes additional columns such as <code>id_in_line</code> if they are not provided.
5. Assigns these DataFrames to the Concordance object.</p>
<hr />
<p>Each of these retrieval functions converts external data formats into FlexiConc’s standard internal structure, allowing you to analyze and visualize your corpus data immediately after loading.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>